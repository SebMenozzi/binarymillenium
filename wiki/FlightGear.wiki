#summary interfacing with flightgear
#labels Featured

= Introduction =

I've recently become interested in making an autopilot application that can control a vehicle in flightgear in response to updates of the state of the vehicle.

Initially I have a small app that accepts udp packets from flightgear (sent with the --native-fdm=socket,out,2, 127.0.0.1, 5500,udp command) and simply prints out altitude.  I've broken the endian checks so non x86 platforms may need to restore them.

It would be easy to add print out of other information, but I may create another udp interface to processing that just sends a smaller custom struct with only the information the autopilot should have.  This will be plotted by processing in timecharts, and also saved to file somewhere.  Processing could also host the autopilot, which would require implementation of the native-ctrl interface- but that shouldn't be hard after getting through the native-fdm interface work.

See this location in svn for the current app:
http://binarymillenium.googlecode.com/svn/trunk/flightgear/

= Details = 

Flightgear has an interface that allows sending and receiving of the state of the vehicle being simulated (the FGNetFDM structure) and the position of control surfaces and other things (the FGNetCtrls structure).

What I do is have flightgear send my c++ application both, then modify the contents of the controls structure with new aileron/elevator/rudder positions and send the modified structure back to flightgear.

The fdm structure contains the position and attitude of the vehicle, so using my application one could code up an autopilot that looks at vehicle state and alters the control surfaces in response.

I'm working in Linux right now with flightgear 1.0, my software would probably compile under Windows in Cygwin but I haven't yet tried that.

To set up flightgear to interact with this correctly, it needs to output the native-ctrl to udp on port 5700, input the native-ctrl on port 5600, and output the native-fdm on port 5500.  The update rates all need to be the same.

= Update = 

I've done some more looking and I think there is software similar to this (and maybe more correctly implemented) in the latest flightgear cvs.  One of the reasons that was so hard to find is there are no documents or web pages that explain it, just a few references in the flightgear mailing list.  